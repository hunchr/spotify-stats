#!/usr/bin/env ruby
# frozen_string_literal: true

require "fileutils"

APP_ROOT = File.expand_path "..", __dir__

def system!(cmd)
  system cmd, exception: true
end

FileUtils.chdir APP_ROOT do
  puts "== Installing dependencies =="
  system! "bundle"

  unless File.exist? ".env"
    puts "\n== Copying .env =="
    FileUtils.copy ".env.example", ".env"
  end

  puts "\n== Prepare database =="
  system! "bin/rails db:prepare"
end
